{{- define "main" -}}


<div class="page-docs-notebook">
  {{ with .Params.top_image }}
  <div class="top-image">
    <img src="{{ . | relURL }}">
  </div>
  {{ end }}
  <div class="container">


    <div class="vue-content notebook-wrap">


      <script src="https://cdn.jsdmirror.com/npm/lodash@4.17.21/lodash.min.js"></script>
      <script src="https://unpkg.com/vue@3.5.18/dist/vue.global.prod.js"></script>
      <div id="app_publications">
        <div class="note-box">

          <ul class="nav nav-tabs months-list">
            <template v-for="(item, index) in reactiveData.monthsData">
              <li  class="nav-item dropdown month-item " v-if="item.contents.length > 0" >
                 <a class="nav-link dropdown-toggle month-text"
                   data-bs-toggle="dropdown"
                   href="#">${monthsMap[item.id]}</a>

                <div class=" note_title_img img_box nav-link dropdown-toggle " data-bs-toggle="dropdown"   data-bs-auto-close="false">
                  <img :src="item.image"  class="month-image"  />
                </div>


                <ul class="dropdown-menu month-parts">
                  <li><a class="dropdown-item" href="#" v-for="(item2, index2) in item.contents"
                         @click.prevent="showNoteContent(item, index2)"
                      >
                     Part ${index2 + 1}
                  </a></li>
                </ul>
              </li>
            </template>

          </ul>

          <div class="note-content-wrap">
            <div class="note-content" v-html="reactiveData.showContent"></div>
          </div>

        </div>
      </div>


      <script>
        //  → https://example.org/docs/
        const baseUrl = '{{ site.BaseURL }}';

        const monthsMap = {
          1: 'Jan',
          2: 'Feb',
          3: 'Mar',
          4: 'Apr',
          5: 'May',
          6: 'Jun',
          7: 'Jly',
          8: 'Aug',
          9: 'Sep',
          10: 'Oct',
          11: 'Nov',
          12: 'Dec',
        }
      </script>

      <script>


        const { createApp, reactive, ref, onMounted, nextTick  } = window.Vue;

        function loadNotebookData() {
          return new Promise((resolve, reject) => {
            // resolve();
            // reject();
            return fetch('{{ "documentation/notebook/data/index.json" | relLangURL }}')
              .then(response => {
                //console.log(response); // 处理你的JSON数据
                return response.json()
                // return response.text()
              })
              .then(data => {
                // console.log(data);
                // const data2 = JSON.parse(data) || []
                const data2 = data  || []
                console.log(data2); // 处理你的JSON数据
                resolve(data2)
              });
          });
        }


        function setup() {
          const reactiveData = reactive({
            showContent: 'CLICK ON THE RED TAB TO VIEW THE INDIVIDUAL LAB RECORDS',
            monthsData: [],
          });

          let allDataList = [];


          onMounted(() => {


          });


          loadNotebookData().then(data => {
            // data.map(item => {
            //   item.image = `${baseUrl}${item.image}`
            // });
            allDataList = [...data];
            reactiveData.monthsData = data;



          });

          function showNoteContent(monthItem, partIndex) {

            reactiveData.showContent = _.get(monthItem, `contents[${partIndex}].content`, '');
          }



          return {
            reactiveData,
            monthsMap,
            showNoteContent,
          };
        }

        createApp({
          delimiters: ['${', '}'],
          setup,
        }).mount("#app_publications");
      </script>

    </div>




  </div>
</div>

{{- end -}}
